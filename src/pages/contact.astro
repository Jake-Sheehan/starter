---
export const prerender = false;

import Layout from "@layouts/Layout.astro";
import ContactForm from "@components/ContactForm.astro";

let formSubmitted: boolean = false;
let resultMessage;

if (Astro.request.method === "POST") {
    formSubmitted = true;
    try {
        const formData = await Astro.request.formData();
        const firstName = formData.get("firstname");
        const lastName = formData.get("lastname");
        const email = formData.get("email");
        const subject = formData.get("subject");
        const message = formData.get("message");

        console.log(`Sent by: ${email}`);
        console.log(`subject: ${subject}`);
        console.log(`${firstName} ${lastName}`);
        console.log(message);

        resultMessage = "form successfully submitted";
    } catch (error) {
        if (error instanceof Error) {
            console.error(error.message);
            resultMessage = "oops, something went wrong";
        }
    }
}
---

<Layout title="Contact">
    <section id="contact-form">
        {formSubmitted ? <p>{resultMessage}</p> : <ContactForm />}
    </section>
</Layout>

<style>
    #contact-form {
        max-inline-size: 500px;
    }
</style>
